---
created: 2025-07-21 23:38
updated: 2025-07-22 15:42
---
- åµæ¸¬æœªé€£çµçš„åœ–ç‰‡æª”æ¡ˆ(é™åˆ¶50é …)

```dataviewjs
const imageExts = ["png", "jpg", "jpeg", "gif", "webp"];
const allImages = app.vault.getFiles().filter(f => {
  let ext = f.extension.toLowerCase();
  return imageExts.includes(ext);
});

let imageUsage = new Map();

for (let img of allImages) {
  imageUsage.set(img.path, { used: false, file: img });
}

for (let file of app.vault.getMarkdownFiles()) {
  const content = await app.vault.read(file);

  for (let img of allImages) {
    const imgName = img.name;
    const regex = new RegExp(`!?\\[\\[${imgName}\\]\\]`, "gi");
    if (regex.test(content)) {
      imageUsage.get(img.path).used = true;
    }
  }
}

const unusedImages = [...imageUsage.values()]
  .filter(info => !info.used)
  .slice(0, 50); // â­ï¸ é™åˆ¶æœ€å¤šé¡¯ç¤º 50 ç­†

if (unusedImages.length === 0) {
  dv.paragraph("âœ… æ‰€æœ‰åœ–ç‰‡éƒ½æœ‰è¢«ä½¿ç”¨ï¼");
} else {
  dv.paragraph(`ğŸ§¹ ä»¥ä¸‹æ˜¯æœªè¢«ä½¿ç”¨çš„åœ–ç‰‡ï¼ˆå‰ 50 ç­†ï¼‰ï¼Œå…± ${unusedImages.length} ç­†ï¼š`);

  let output = unusedImages.map((info, index) => `${index + 1}. [[${info.file.name}]]`).join("\n");
  dv.paragraph(output);
}
```



- åµæ¸¬æ‰€æœ‰æª”æ¡ˆï¼Œä¾ç…§å¤§å°æ’åº(å‰50)

```dataviewjs
const allFiles = app.vault.getFiles();

let filesWithSize = allFiles.map(f => ({
  name: f.name,
  path: f.path,
  size: f.stat.size
}));

// æŒ‰å¤§å°ç”±å¤§åˆ°å°æ’åº
filesWithSize.sort((a, b) => b.size - a.size);

// é™åˆ¶å‰ 50 ç­†
let top50 = filesWithSize.slice(0, 50);

// æ ¼å¼åŒ–æˆè¡¨æ ¼è³‡æ–™ï¼ˆKB é¡¯ç¤ºï¼‰
let tableRows = top50.map(f => [
  `[[${f.name}]]`,
  (f.size / 1024).toFixed(2) + " KB",
  f.path
]);

// é¡¯ç¤ºè¡¨æ ¼
dv.table(["æª”å", "å¤§å°", "è·¯å¾‘"], tableRows);

```