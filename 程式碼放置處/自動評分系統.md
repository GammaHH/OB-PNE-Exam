---
created: 2025-07-21 12:21
updated: 2025-07-22 15:40
---
1. 題號（來自 ##### 114-2(79)）
2. 答案（來自 答案：[A-D]）
3. 你的作答（來自 我的回答： 後第一個出現的 [A-D]，可以有空格或是其他文字，無答案"ABCD"設為未作答）
4. 會將我的回答：這一行的所有文字顯示在原始輸入

```dataviewjs
let file = app.workspace.getActiveFile();
if (!file) {
  dv.paragraph("⚠️ 無法取得目前筆記檔案。請在有效筆記中使用此區塊。");
  return;
}

let text = await app.vault.read(file);
let lines = text.split("\n");

let results = [];
let current = null;

for (let line of lines) {
  let titleMatch = line.match(/^#####\s*\d+-\d+\((\d+)\)/);
  if (titleMatch) {
    if (current) results.push(current);
    current = { num: Number(titleMatch[1]), ans: null, mine: null, mineRaw: "" };
    continue;
  }

  if (!current) continue;

  let ansMatch = line.match(/^答案：([A-D])/);
  if (ansMatch) {
    current.ans = ansMatch[1];
    continue;
  }

  if (line.startsWith("我的回答：")) {
    current.mineRaw = line.replace("我的回答：", "").trim(); // 保留整段
    let directMatch = current.mineRaw.match(/([A-D])/);       // 抓出第一個 A–D
    if (directMatch) {
      current.mine = directMatch[1];
    }
    continue;
  }
}

if (current) results.push(current); // ✅ 正確位置：for 迴圈外

// === 評分 ===
let score = 0;
let wrong = [];

for (let q of results) {
  if (q.ans && q.mine && q.ans === q.mine) {
    score += 1.25;
  } else {
    wrong.push(q.num);
  }
}

// === 輸出 ===
dv.paragraph(`🎯 **總分：${score.toFixed(2)} / ${(results.length * 1.25).toFixed(2)}**`);
if (wrong.length > 0) {
  dv.paragraph("❌ 答錯或未填的題號：" + wrong.join(", "));
} else {
  dv.paragraph("✅ 全部答對！");
}

dv.table(["題號", "標準答案", "我的作答", "原始輸入"],
  results.map(q => [
    q.num,
    q.ans ?? "❓",
    q.mine ?? "❓" + (q.mine === null ? "（未作答）" : ""),
    q.mineRaw || "（無內容）"
  ])
);

```