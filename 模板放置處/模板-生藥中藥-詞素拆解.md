---
<%* 
// 1ï¸âƒ£ è©¢å•ç­†è¨˜é¡å‹
let noteType = await tp.system.prompt("è«‹é¸æ“‡ç­†è¨˜é¡å‹ï¼š\n1ï¸âƒ£ ç”Ÿè—¥è©å¡ \n2ï¸âƒ£ ä¸­è—¥è©å¡");


noteType = (noteType === "1") ? "ç”Ÿè—¥è©å¡" : "ä¸­è—¥è©å¡";

// 2ï¸âƒ£ è¨­å®šé è¨­è³‡æ–™ä¾†æº
let sourceList = [];
if (noteType === "ç”Ÿè—¥è©å¡") {
    sourceList.push("A'phar ç”Ÿè—¥å­¸");
} else {
    sourceList.push("å¸¸ç”¨ä¸­è—¥ç¬¬äºŒç‰ˆ");
}



// 3ï¸âƒ£ è©¢å•ç´°é …åˆ†é¡
let subCategory = "";
if (noteType === "ç”Ÿè—¥è©å¡") {
    subCategory = await tp.system.prompt("è«‹è¼¸å…¥æ‰€å±¬ç« ç¯€") || "æœªåˆ†é¡";
} else {
    subCategory = await tp.system.prompt("è«‹è¼¸å…¥ç´°é …åˆ†é¡") || "æœªåˆ†é¡";
}

// 4ï¸âƒ£ æ˜¯å¦å¡«å¯«é¡å¤–ä¾†æºï¼Ÿ
let includeExtraSource = await tp.system.prompt("æ˜¯å¦å¡«å¯«é¡å¤–ä¾†æºï¼Ÿï¼ˆY?ï¼‰");
if (includeExtraSource.toLowerCase() === "y") {
    let source2 = await tp.system.prompt("è«‹è¼¸å…¥é¡å¤–è³‡æ–™ä¾†æº") || "æœªå¡«å¯«";
    sourceList.push(source2);
}

// 5ï¸âƒ£ è¨­å®šæ¨™ç±¤
let tagList = [noteType];  // é è¨­æ¨™ç±¤ç‚ºã€Œç”Ÿè—¥è©å¡ã€æˆ–ã€Œä¸­è—¥è©å¡ã€
tagList.push(subCategory); // åŠ å…¥ç´°é …åˆ†é¡

// 6ï¸âƒ£ è®“ä½¿ç”¨è€…ä¸æ–·è¼¸å…¥é¡å¤–æ¨™ç±¤
while (true) {
    let newTag = await tp.system.prompt("è«‹è¼¸å…¥é¡å¤–æ¨™ç±¤ï¼ˆæŒ‰å–æ¶ˆæˆ–ç•™ç©ºçµæŸï¼‰");
    if (!newTag) break; 
    tagList.push(newTag);
}

// 7ï¸âƒ£ ç§»é™¤é‡è¤‡æ¨™ç±¤
tagList = [...new Set(tagList)]; 

// â¤ é¡å¤–è™•ç†ä¸€å€‹ JS é™£åˆ—æ ¼å¼çš„ excludeTags å­—ä¸²ï¼Œä¾› dataview ä½¿ç”¨
let excludeTags = [noteType];
let excludeTagsLiteral = JSON.stringify(excludeTags);
%>
category: ä¸­è—¥ç”Ÿè—¥å­¸
tags: <%- JSON.stringify(tagList) %>
created: <% tp.date.now("YYYY-MM-DD") %>
updated: <% tp.file.last_modified_date("YYYY-MM-DD") %>
source: <%- JSON.stringify(sourceList) %>
Abstract: "<%- noteType %>"
---

#é¦–åˆ· #review

### 1.å£è¨£/ç†è§£

?
- **å£è¨£**ï¼š
- **ç†è§£**ï¼š
> 
	

???

###### è—¥ç†()
?
- 

???

###### å¸¸è¦‹ç”¨é€”()
?
- 

???

###### æ–¹åŠ‘()
?
- 

???



### 2.è©ç´ æ‹†è§£



**å®Œæ•´çµæ§‹ï¼š**



#### ğŸ“Œ ç›¸é—œè—¥æé€£çµ

```dataviewjs

const excludeTags = <%- excludeTagsLiteral %>;
const currentTags = dv.current().tags?.filter(t => !excludeTags.includes(t)) ?? [];


//é¸å–ç¯„åœï¼Œåƒ…æœå°‹åœ‹è€ƒè³‡æ–™å¤¾çš„æª”æ¡ˆ
let allCandidates = dv.pages()
  .where(p => p.file?.path?.startsWith("åœ‹è€ƒ/") && p.tags && p.file.name !== dv.current().file.name);


// å…ˆåˆ†å‡º multi å’Œ single
let multiMatch = [];
let singleMatch = [];

for (let p of allCandidates) {
  const matchCount = currentTags.reduce((acc, tag) => acc + (p.tags.includes(tag) ? 1 : 0), 0);
  if (matchCount >= 2) {
    multiMatch.push(p);
  } else if (matchCount === 1) {
    singleMatch.push(p);
  }
}

// å»ºç«‹ singleMatch çš„åˆ†é¡ group
let singleGroups = {};
for (let p of singleMatch) {
  let matchedTag = currentTags.find(tag => p.tags.includes(tag));
  if (matchedTag) {
    if (!singleGroups[matchedTag]) singleGroups[matchedTag] = [];
    singleGroups[matchedTag].push(p);
  }
}

// åˆä½µç¸½ç­†æ•¸ï¼ˆç„¡é‡è¤‡ï¼‰
let multiPaths = new Set(multiMatch.map(p => p.file.path));
let totalUnique = new Set([...multiMatch, ...singleMatch].map(p => p.file.path)).size;

dv.header(5, `ç›¸é—œè—¥ç‰©ï¼ˆå…± ${totalUnique} ç­†ï¼‰`);

if (multiMatch.length > 0) {
  dv.header(6, `â–¸ ${currentTags.join("ã€")}ï¼ˆ${multiMatch.length}ï¼‰`);
  dv.list(
    multiMatch.map(p => {
      const tagsToShow = p.tags.filter(t => !excludeTags.includes(t));
      return `${p.file.link}ã€€${tagsToShow.join("ã€")}`;
    })
  );
}

// é¡¯ç¤ºå–®ä¸€æ¨™ç±¤å‘½ä¸­åˆ†é¡å¾Œçš„ç­†è¨˜
for (let [tag, pages] of Object.entries(singleGroups)) {
  dv.header(6, `â–¸ ${tag}ï¼ˆ${pages.length}ï¼‰`);
  dv.list(
    pages.map(p => {
      const tagsToShow = p.tags.filter(t => !excludeTags.includes(t) && t !== tag);
      return `${p.file.link}ã€€${tagsToShow.join("ã€")}`;
    })
  );
}
if (multiMatch.length === 0 && Object.keys(singleGroups).length === 0) {

  dv.paragraph("æ²’æœ‰æ‰¾åˆ°èˆ‡æœ¬è—¥æå…·æœ‰ç›¸åŒæ¨™ç±¤çš„å…¶ä»–ç­†è¨˜ã€‚");
}
````

### 3.<% tp.file.title %> ç›¸é—œçŸ¥è­˜é»




### 4.é–ƒå¡å€

- <% tp.file.title %> åŸºæº:::
- <% tp.file.title %> æ‰€å±¬ç§‘åˆ¥::
- <% tp.file.title %> ç”¨éƒ¨::




